<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Derafu: ETL - From Spreadsheets to Databases Seamlessly</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.1.0/github-markdown-light.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/command-line/prism-command-line.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/match-braces/prism-match-braces.min.css" rel="stylesheet" />
    <link href="https://derafu.org/css/styles.min.css" rel="stylesheet" />
    </head>
<body>
                <div id="header-container" class="sticky-top"></div>
    
            <div class="container">
            <div class="row">
                <main class="col-md-9">
                    <div class="container py-4">
    <div class="markdown-body"><h1><a id="content-schema-visualization-with-derafu-etl" href="schema-visualization.html#content-schema-visualization-with-derafu-etl" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Schema Visualization with Derafu ETL</h1>
<p>Derafu ETL includes powerful tools for visualizing database schemas through various output formats. These visualizations are useful for documentation, planning, and understanding the structure of your data.</p>
<ul class="table-of-contents">
<li><a href="schema-visualization.html#content-available-visualization-formats">Available Visualization Formats</a></li>
<li><a href="schema-visualization.html#content-using-schema-targets">Using Schema Targets</a>
<ul>
<li><a href="schema-visualization.html#content-basic-usage">Basic Usage</a></li>
</ul>
</li>
<li><a href="schema-visualization.html#content-markdown-schema">Markdown Schema</a></li>
<li><a href="schema-visualization.html#content-d2-diagrams">D2 Diagrams</a></li>
<li><a href="schema-visualization.html#content-practical-applications">Practical Applications</a>
<ul>
<li><a href="schema-visualization.html#content-documentation">Documentation</a></li>
<li><a href="schema-visualization.html#content-visual-modeling">Visual Modeling</a></li>
<li><a href="schema-visualization.html#content-schema-migration">Schema Migration</a></li>
</ul>
</li>
<li><a href="schema-visualization.html#content-integration-with-etl-pipeline">Integration with ETL Pipeline</a></li>
</ul>
<h2><a id="content-available-visualization-formats" href="schema-visualization.html#content-available-visualization-formats" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Available Visualization Formats</h2>
<p>Derafu ETL supports multiple visualization formats through schema targets:</p>
<ul>
<li><strong>Markdown</strong>: Human-readable documentation.</li>
<li><strong>D2</strong>: Interactive entity-relationship diagrams.</li>
<li><strong>Text</strong>: Simple text representation.</li>
<li><strong>SQL</strong>: Database creation scripts.</li>
<li><strong>Doctrine Schema</strong>: Programmatic schema representation.</li>
</ul>
<h2><a id="content-using-schema-targets" href="schema-visualization.html#content-using-schema-targets" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Using Schema Targets</h2>
<p>Schema targets implement the <code>SchemaTargetInterface</code> and convert a schema to a specific format.</p>
<h3><a id="content-basic-usage" href="schema-visualization.html#content-basic-usage" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Basic Usage</h3>
<p>All schema targets follow a similar pattern:</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Database\DatabaseManager;
use Derafu\ETL\Schema\Target\CustomSchemaTarget; // Just an example.

// Connect to the database.
$manager = new DatabaseManager();
$database = $manager-&gt;connect('database.sqlite');

// Get the schema.
$schema = $database-&gt;schema();

// Create the target.
$target = new CustomSchemaTarget();

// Apply the schema to the target.
$output = $target-&gt;applySchema($schema);

// Use the output.
file_put_contents('output-file.custom', $output);
</code></pre>
<h2><a id="content-markdown-schema" href="schema-visualization.html#content-markdown-schema" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Markdown Schema</h2>
<p>The <code>MarkdownSchemaTarget</code> generates comprehensive Markdown documentation for your database schema.</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Schema\Target\MarkdownSchemaTarget;

$target = new MarkdownSchemaTarget();
$markdown = $target-&gt;applySchema($schema);

file_put_contents('schema.md', $markdown);
</code></pre>
<p>The generated Markdown includes:</p>
<ul>
<li>Table of contents.</li>
<li>Detailed table definitions.</li>
<li>Column information with types and constraints.</li>
<li>Primary keys, indexes, and foreign key relationships.</li>
</ul>
<p>Example output:</p>
<pre><code class="line-numbers match-braces language-markdown"># Database Schema

## Table of Contents

- [Table: users](#table-users)
- [Table: posts](#table-posts)

## Table: users {#table-users}

### Columns

| Column     | Type        | Attributes              | Description |
|------------|-------------|-------------------------|-------------|
| id         | integer     | PRIMARY KEY / NOT NULL  |             |
| username   | string(100) | NOT NULL                |             |
| email      | string(255) | NOT NULL                |             |
| created_at | datetime    | NOT NULL                |             |

### Primary Key

- Columns: `id`

### Indexes

| Name         | Columns  | Type   | Flags |
|--------------|----------|--------|-------|
| idx_username | username | INDEX  |       |
| idx_email    | email    | UNIQUE |       |
</code></pre>
<h2><a id="content-d2-diagrams" href="schema-visualization.html#content-d2-diagrams" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>D2 Diagrams</h2>
<p>The <code>D2SchemaTarget</code> generates diagrams in <a rel="nofollow noopener noreferrer" target="_blank" class="external-link" href="https://d2lang.com/">D2 format</a>, a modern diagram scripting language.</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Schema\Target\D2SchemaTarget;

$target = new D2SchemaTarget(
    detailLevel: D2SchemaTarget::DETAIL_FULL,
    direction: D2SchemaTarget::DIRECTION_RIGHT,
    layout: D2SchemaTarget::LAYOUT_DEFAULT,
    includeIndexes: true
);
$d2 = $target-&gt;applySchema($schema);

file_put_contents('schema.d2', $d2);
</code></pre>
<p>Options include:</p>
<ul>
<li><strong>Detail Level</strong>: <code>DETAIL_FULL</code>, <code>DETAIL_KEYS_ONLY</code>, <code>DETAIL_MINIMAL</code>.</li>
<li><strong>Direction</strong>: <code>DIRECTION_UP</code>, <code>DIRECTION_DOWN</code>, <code>DIRECTION_LEFT</code>, <code>DIRECTION_RIGHT</code>.</li>
<li><strong>Layout</strong>: <code>LAYOUT_DEFAULT</code>, <code>LAYOUT_CLUSTERED</code>, <code>LAYOUT_HIERARCHICAL</code>.</li>
<li><strong>Include Indexes</strong>: Whether to include indexes in the diagram.</li>
</ul>
<p>Example D2 output:</p>
<pre><code class="line-numbers match-braces"># Database Schema

direction: right

# Tables
users: {
  shape: sql_table
  id: integer NOT NULL pk
  username: string(100) NOT NULL column
  email: string(255) NOT NULL column
  created_at: datetime NOT NULL column
}

posts: {
  shape: sql_table
  id: integer NOT NULL pk
  user_id: integer NOT NULL fk
  title: string(255) NOT NULL column
  content: text column
  created_at: datetime NOT NULL column
}

# Relationships
posts -&gt; users
</code></pre>
<h2><a id="content-practical-applications" href="schema-visualization.html#content-practical-applications" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Practical Applications</h2>
<h3><a id="content-documentation" href="schema-visualization.html#content-documentation" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Documentation</h3>
<p>Generate comprehensive documentation for your database:</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Database\DatabaseManager;
use Derafu\ETL\Schema\Target\MarkdownSchemaTarget;

$manager = new DatabaseManager();
$database = $manager-&gt;connect('production.sqlite');

$target = new MarkdownSchemaTarget();
$docs = $target-&gt;applySchema($database-&gt;schema());

file_put_contents('database-schema.md', $docs);
</code></pre>
<h3><a id="content-visual-modeling" href="schema-visualization.html#content-visual-modeling" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Visual Modeling</h3>
<p>Create visual diagrams for presentations or analysis:</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Schema\Target\D2SchemaTarget;

// Filter to only show specific tables.
$target = new D2SchemaTarget(
    tableFilter: ['users', 'posts', 'comments']
);

$diagram = $target-&gt;applySchema($schema);
file_put_contents('entity-relationship.d2', $diagram);
</code></pre>
<h3><a id="content-schema-migration" href="schema-visualization.html#content-schema-migration" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Schema Migration</h3>
<p>Export a schema definition to create a new database:</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Schema\Target\SqliteSchemaTarget;

$target = new SqliteSchemaTarget();
$sql = $target-&gt;applySchema($schema);

file_put_contents('schema.sql', $sql);
</code></pre>
<h2><a id="content-integration-with-etl-pipeline" href="schema-visualization.html#content-integration-with-etl-pipeline" class="text-decoration-none small text-muted" aria-hidden="true" title="Permalink"><i class="fa-solid fa-link"></i> </a>Integration with ETL Pipeline</h2>
<p>Schema visualization can be integrated with the ETL pipeline for comprehensive documentation:</p>
<pre><code class="line-numbers match-braces language-php">use Derafu\ETL\Pipeline\Pipeline;
use Derafu\ETL\Schema\Target\MarkdownSchemaTarget;

// Run ETL pipeline.
$pipeline = new Pipeline();
$result = $pipeline
    -&gt;extract('data.xlsx')
    -&gt;transform()
    -&gt;load('database.sqlite')
    -&gt;execute();

// Document the resulting database.
$database = $result-&gt;target()-&gt;database();
$target = new MarkdownSchemaTarget();
$docs = $target-&gt;applySchema($database-&gt;schema());

file_put_contents('database-schema.md', $docs);
</code></pre>
</div>
</div>
                </main>
                <div class="col-md-3 py-4">
                    <div class="list-group mb-4">
                        <li class="list-group-item d-flex justify-content-between align-items-start">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">Package Info</div>
                                <span class="smal text-muted">
                                    <a href="https://github.com/derafu/etl" target="_blank" class="link-secondary text-decoration-none">
                                        <i class="fa-brands fa-github"></i>
                                        derafu/etl
                                    </a>
                                </span>
                                <div class="my-2">
                                    <img src="https://img.shields.io/github/stars/derafu/etl" alt="GitHub Repo stars">
                                    <img src="https://img.shields.io/github/forks/derafu/etl" alt="GitHub forks">
                                </div>
                            </div>
                        </li>
                        <a href="index.html" class="list-group-item list-group-item-action ">
                            README
                        </a>
                    </div>
                    <div class="list-group mb-4">
                        <li class="list-group-item d-flex justify-content-between align-items-start">
                            <div class="ms-2 me-auto">
                            <div class="fw-bold">Docs</div>
                            <span class="smal text-muted">Guides & Examples</span>
                            </div>
                        </li>
                        <a href="architecture.html" class="list-group-item list-group-item-action ">
                            Architecture
                        </a>
                        <a href="schema-visualization.html" class="list-group-item list-group-item-action active">
                            Schema Visualization
                        </a>
                    </div>
                </div>
            </div>
        </div>
    
            <div id="footer-container"></div>
        <script src="https://derafu.org/js/derafu.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/show-language/prism-show-language.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/command-line/prism-command-line.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/match-braces/prism-match-braces.min.js"></script>
    </body>
</html>
